<html lang="en">
<head>


  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  <title>Earth Alert</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!--Font
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">

  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->

    <link rel="stylesheet" type="text/css" href="/static/css/main.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/static/css/normalize.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/static/css/skeleton.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/static/css/animate.css" media="screen" />



  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <link rel="icon" type="image/png" href="/static/img/grey-logo.png">

<!--Scripts
–––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>




</head>
<body>

  <!-- Primary Page Layout
–––––––––––––––––––––––––––––––––––––––––––––––––– -->

    <div class="navigation overlay">
		<div id="titlecard_wrapper">
			<img src="/static/img/grey-logo.png">
			<div id="header_text">Slide</div>
		</div>
         <div id="warning_box"></div>
    </div>




        <div id="mapContainer">
            <div id="map"></div>
            <script>
                var map;
                function initMap(){
                    map = new google.maps.Map(document.getElementById('map'), {
                        mapTypeId: 'terrain',
                        zoom: 3,
                        minZoom: 2,
                        maxZoom: 14,
                        center: {lat: 33, lng: 3}
                    });
                    map.data.setStyle({ fillColor:'red', strokeWeight: 0, fillOpacity: 0.8});
                    map.data.loadGeoJson("{{ geo_url }}");
                    <!-- 'https://pmmpublisher.pps.eosdis.nasa.gov/products/global_landslide_nowcast_30mn/export/Global/2017/118/global_landslide_nowcast_30mn.20170428.230000.geojson' -->
                }
            </script>
            <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDqqZYLz6Y4lJGuBatmPuHJxPt-Y75kNag&callback=initMap"></script>
        </div>

	<input id="file_input" type="file" name="name" style="display:none;" />

    <div class="footer">
			<div id="upload" onClick="toggle_display('imageUploadContainer');"><img src="/static/img/upload.png" /></div>
            <div id="report" onClick="toggle_display('editReportContainer');"><img src="/static/img/edit.png" /></div>
            <div id="info" onClick="toggle_display('infoContainer');"><img src="/static/img/info.png" /></div>
    </div>

    <div class="modals">
            <div id="imageUploadContainer" class="displayNone">
                <p>Upload your photos to help the community know of dangerous situations.</p>
                <button class="button-primary" value="Upload" id="upload" onclick="get_file();" >Upload</button>
            </div>
            <div id="editReportContainer" class="displayNone">
                <p>Give a brief description of your current situation.</p>
                <input type="text" placeholder="A brief description"></input>
                <button class="button-primary" value="Update" onclick="report_event();">Update</button>
            </div>
            <div id="infoContainer" class="displayNone">
                <img src="https://placehold.it/350x150">
                <h4>About EarthAlert</h4>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas malesuada enim sed hendrerit varius. Pellentesque vestibulum elit ex, ut bibendum eros laoreet sit amet. Donec felis lacus, vulputate ut malesuada ac, consectetur ac eros. In orci urna, porta in tristique vitae, gravida in urna. </p>
                <h4>Meet the Team</h4>
                <p></p>
            </div>
        </div>





<!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  	<script>

        function toggle_display( name ){
            var e = document.getElementById(name);
            clear_displays( e );
            if(e.className.includes('displayBlock')){
                e.classList.remove('displayBlock');
            } else {
                e.classList.add('displayBlock');
            }
        }

        function clear_displays( e ){
            var items = document.getElementsByClassName('displayNone');
            for(var i=0;i<items.length;i++){
                if(items[i]!=e){
                    items[i].className = "displayNone";
                }
            }
        }


		EVENTS={{ events|safe }};
		IMAGES={{ images|safe }};

		function init_events( events ){
            var contentString = [];
			for(var i =0; i < events.length;i++){
				var data = events[i];
				contentString.push( '<div id="content">'+
	            						'<h3 id="event_title">Landslide Report:</h3>'+
	            						'<div id="event_description">'+
	            							'<p>' + data.description + '</p>' +
											'<b>(' + data.datetime + ')</b>'+
	            						'</div>'+
	            					'</div>');

		        var infowindow = new google.maps.InfoWindow({
		        	content: contentString[i]
		        });
				var marker = new google.maps.Marker({
					position: {lat: parseFloat(data.latitude + 0.01*Math.random()), lng:parseFloat(data.longitude - 0.01*Math.random())},
					title: 'Community Report',
                    icon: '/static/img/caution.png',
					map: map
				});
				marker.addListener('click', function(){
					infowindow.open(map, marker);
				});
			}
		}

		function init_images( images ){
            var contentString = [];
			var images={{ events|safe }};
			for(var i =0; i < images.length;i++){
				var image = images[i];
				contentString.push( '<div id="content">'+
	            							'<a href="' + image.path + '"><img src="' + image.path + '" /></a>' +
	            						'</div>'+
	            					'</div>');

		        var infowindow = new google.maps.InfoWindow({
		        	content: contentString[i]
		        });
				var marker = new google.maps.Marker({
					position: {lat: parseFloat(image.latitude + 0.01*Math.random()), lng:parseFloat(image.longitude - 0.01*Math.random())},
					title: 'User Image',
					map: map
				});
				marker.addListener('click', function(){
					infowindow.open(map, marker);
				});
			}
		}

		init_events( EVENTS );
		init_images( IMAGES );

	</script>
	<script src="static/js/earthalert.js"></script>
</body>
</html>
